Definitions:
    # test data
    data: {filename: asp/examples/data.lp}

    define: {filename: asp/define.lp}
    generate: {filename: asp/generate.lp}
    test: {filename: asp/test.lp}
    features: {filename: asp/features.lp}
    optimize: {filename: asp/optimize.lp}

    # program to test constraints
    no_opt: {group: [data, define, generate, test, features]}
    no_gen: {group: [data, define, test, features]}
    draco: {group: [data, define, generate, test, features, optimize]}

Test a implies b:
    Program: |
        b :- a.
        a.
        :- not b.
    Expect: SAT

Test program by itself is satisfiable:
    Modules: no_opt
    Expect: SAT

Test valid values:
    Modules: no_opt
    Expect: SAT

    Test channel:
        Program: |
            :- not channel(_,x).

    Test field:
        Program: |
            :- not field(_,s1).

    Test type:
        Program: |
            :- not type(_,quantitative).

    Test aggregate:
        Program: |
            :- not aggregate(_,mean).

    Test bin:
        Program: |
            :- not bin(_,10).

    Test zero:
        Program: |
            :- not zero(_).

    Test fieldtype:
        Program: |
            :- not fieldtype(_,string).

    Test mark:
        Program: |
            :- not mark(bar).

    Test data size:
        Program: |
            data_size(10).

Test invalid values:
    Modules: no_opt
    Expect: UNSAT

    Test channel:
        Program: |
            :- not channel(_,foo).

    Test field:
        Program: |
            :- not field(_,foo).

    Test type:
        Program: |
            :- not type(_,foo).

    Test aggregate:
        Program: |
            :- not aggregate(_,foo).

    Test bin:
        Program: |
            :- not bin(_,-1).

    Test fieldtype:
        Program: |
            :- not fieldtype(_,foo).

    Test mark:
        Program: |
            :- not mark(foo).

    Test data size:
        Program: |
            data_size(-10).

Test constraints:
    Modules: no_opt

    Test can use binning:
        Program: |
            encoding(e).
            :- not bin(e,_).
        Expect: SAT

    Test can use aggregation:
        Program: |
            encoding(e).
            :- not aggregate(e,_).
        Expect: SAT

    Test cannot use aggregation and binning:
        Program: |
            encoding(e).
            :- not aggregate(e,_).
            :- not bin(e,_).
        Expect: UNSAT

    Test cannot use field with count:
        Program: |
            encoding(e).
            :- not aggregate(e,count).
            :- not field(e,n1).
        Expect: UNSAT

    Test can use string as o:
        Program: |
            encoding(e).
            :- not field(e,s1).
            :- not type(e,ordinal).
        Expect: SAT

    Test cannot use string as q:
        Program: |
            encoding(e).
            :- not field(e,s1).
            :- not type(e,quantitative).
        Expect: UNSAT

    Test cannot bin temporal:
        Program: |
            fieldtype(d,date).
            encoding(e).
            field(e,d).
            :- not type(e,temporal).
            :- not bin(e,_).
        Expect: UNSAT

    Test cannot use log with string:
        Program: |
            encoding(e).
            field(e,s1).
            :- not log(e).
        Expect: UNSAT

    Test can log number:
        Program: |
            encoding(e).
            field(e,n1).
            :- not log(e).
        Expect: SAT

    Test cannot use log with binned data because it is discrete:
        Program: |
            encoding(e).
            :- not log(e).
            :- not bin(e).
        Expect: UNSAT

    Test cannot use zero with string:
        Program: |
            encoding(e).
            field(e,s1).
            :- not zero(e).
        Expect: UNSAT

    Test can zero number:
        Program: |
            encoding(e).
            field(e,n1).
            :- not zero(e).
        Expect: SAT

    Test cannot use zero with binned data because it is discrete:
        Program: |
            encoding(e).
            :- not zero(e).
            :- not bin(e).
        Expect: UNSAT

    Test can compute average of a number:
        Program: |
            encoding(e).
            field(e,n1).
            :- not aggregate(e,mean).
        Expect: SAT

    Test cannot compute average of a string:
        Program: |
            encoding(e).
            field(e,s1).
            :- not aggregate(e,mean).
        Expect: UNSAT

    Test cannot aggregate nominal:
        Program: |
            encoding(e).
            :- not aggregate(e,_).
            :- not type(e,nominal).
        Expect: UNSAT

    Test can aggregate continuous:
        Program: |
            encoding(e).
            :- not aggregate(e,_).
        Expect: SAT

    Test without stack if color:
        Program: |
            encoding(e1).
            channel(e1,x).
            field(e1,s1).
            type(e1,ordinal).

            encoding(e2).
            channel(e2,y).
            field(e2,n1).
            type(e2,quantitative).
            zero(e2).

            encoding(e3).
            channel(e3,color).
            field(e3,s2).
            type(e3,nominal).

            mark(bar).
        Expect: UNSAT

    Test with stack if color:
        Program: |
            encoding(e1).
            channel(e1,x).
            field(e1,s1).
            type(e1,ordinal).

            encoding(e2).
            channel(e2,y).
            field(e2,n1).
            type(e2,quantitative).
            zero(e2).

            encoding(e3).
            channel(e3,color).
            field(e3,s2).
            type(e3,nominal).

            mark(bar).
            stack(zero).
        Expect: SAT

Test helpers:
    Modules: no_gen

    Test overlap:
        Program: |
            mark(point).

            encoding(e1).
            field(e1,s1).
            channel(e1,x).
            type(e1,ordinal).

            encoding(e2).
            field(e2,n1).
            channel(e2,y).
            type(e2,quantitative).

            :- no_overlap.
        Expect: SAT

    Test no overlap aggregation:
        Program: |
            mark(point).

            encoding(e1).
            field(e1,s1).
            channel(e1,x).
            type(e1,ordinal).

            encoding(e2).
            field(e2,n1).
            channel(e2,y).
            type(e2,quantitative).
            aggregate(e2,mean).

            :- no_overlap.
        Expect: UNSAT

    Test no overlap cardinality:
        Program: |
            mark(point).

            encoding(e1).
            field(e1,n2).
            channel(e1,x).
            type(e1,ordinal).

            encoding(e2).
            field(e2,n1).
            channel(e2,y).
            type(e2,quantitative).

            :- no_overlap.
        Expect: UNSAT

Test soft constraints:
    Modules: no_gen

    Test high entropy data:
        Program: |
            fieldtype(n3,number).
            cardinality(n3,200).
            entropy(n3,1).

            mark(point).

            encoding(e).
            field(e,n3).
            channel(e,x).
            type(e,quantitative).

            :- not feature_term(position_entropy, e).
        Expect: SAT

    Test only row and column:
        Program: |
            fieldtype(n3,number).
            cardinality(n3,10).

            mark(text).

            encoding(e).
            field(e,n3).
            channel(e,column).
            type(e,ordinal).

            type(e1,quantitative).
            field(e2,n3).
            channel(e3,text).

            :- not feature_term(only_row_column).
        Expect: SAT

    Test skew with zero:
        Program: |
            fieldtype(n3,number).
            cardinality(n3,10).
            extent(n3,10,12).

            mark(tick).

            encoding(e).
            field(e,n3).
            channel(e,x).
            type(e,quantitative).
            zero(e).

            :- not feature_term(zero_skew).
        Expect: SAT

    Test zero with data that covers it:
        Program: |
            fieldtype(n3,number).
            cardinality(n3,200).
            entropy(n3,1).
            extent(n3,-10,10).

            mark(point).

            encoding(e).
            field(e,n3).
            channel(e,x).
            type(e,quantitative).
            zero(e).

            :- not feature_term(includes_zero).

        Expect: UNSAT
