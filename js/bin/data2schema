#!/usr/bin/env node

const data2schema = require('../build/data2schema').default;

const stdin = process.stdin;
const stdout = process.stdout;
const inputChunks = [];

stdin.on('data', chunk => {
  stdout.write(chunk);
  inputChunks.push(chunk);
});

stdin.on('end', () => {
  stdout.write('end');
  stdout.write(`${inputChunks[inputChunks.length - 1]}`);
  const inputJSON = JSON.parse(inputChunks.join());
  stdout.write(inputJSON);
  const result = data2schema(inputJSON);
  stdout.write(JSON.stringify(result));
});
